import{C as b,A as L}from"./index-b57fdfd1.js";import{G as P}from"./Graphics-09363f9f.js";import{r as X,o as A,a as D,c as S}from"./index-fc2707c8.js";const k=()=>{const l="0123456789ABCDEF",r=l.length;let p="#";for(let x=0;x<6;x++)p+=l[Math.floor(Math.random()*r)];return p},E=(l,r)=>{const p=Math.random();return Math.round(p*(r-l)+l)};const T={__name:"PanZoom",setup(l){const r=X(null),p=async(n,e)=>{const t=new L;return await t.init({width:n,height:e,antialias:!0,resolution:window.devicePixelRatio||1,autoDensity:!0}),t},x=n=>{const{x:e,y:t,width:o,height:c}=n,s=[];for(let a=0;a<20;a++){const d=E(e,e+o),i=E(t,t+c),u=k(),y=new P().circle(0,0,20).fill(u);y.position.set(d,i),s.push(y)}return s},C=n=>{let e=!1,t={x:0,y:0};const o=s=>{if(!e)return;const a=n.position.x,d=n.position.y,i={x:s.pageX,y:s.pageY},u={x:i.x-t.x+a,y:i.y-t.y+d};n.position.set(u.x,u.y),t=i},c=()=>{e=!1,window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",c)};n.parent.addEventListener("mousedown",s=>{t={x:s.pageX,y:s.pageY},e=!0,window.addEventListener("mouseup",c),window.addEventListener("mousemove",o)})},M=({element:n,container:e,boundingRect:t})=>{const a=d=>{d.preventDefault();const{pageX:i,pageY:u,deltaY:y}=d,f=e.scale.x||1,h={x:e.position.x,y:e.position.y},m=y>0?f*1.02:f/1.02;if(m>8||m<.3)return;const g=i-t.left,w=u-t.top,R=g-h.x,Y=w-h.y,v={x:R/f,y:Y/f},_={x:-v.x*m+g,y:-v.y*m+w};e.updateTransform({x:_.x,y:_.y,scaleX:m,scaleY:m})};n.addEventListener("wheel",a,{passive:!1})},B=async n=>{const{element:e,boundingRect:t}=n,o=await p(t.width,t.height);o.canvas.className="canvas",e.appendChild(o.canvas);const c=o.screen,s=x(c),a=new b;a.addChild(...s),o.stage.addChild(a),o.stage.eventMode="static",o.stage.hitArea=c,o.stage.interactiveChildren=!1,M({element:e,boundingRect:t,container:a}),C(a)};return A(()=>{const n=r.value,e=n.getBoundingClientRect();B({element:n,boundingRect:e})}),(n,e)=>(D(),S("div",{ref_key:"boxElementRef",ref:r,class:"box"},null,512))}};export{T as default};
