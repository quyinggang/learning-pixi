import{E as p,T as z,w as m,c as k,p as P,i as X,L as E,D as A,C as f,R as T,I as H,a as K,V as U,d as q,e as L,b as ee,B as te,O as se,f as ie,v as ae,A as re,G as y,g as ne,S as oe}from"./index-45511ab4.js";import{T as ce,C as le}from"./TextStyle-04dfec62.js";import{r as de,o as he,a as ue,c as pe}from"./index-9ed3612e.js";class fe{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(t=>{this._assetList.push(t)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}const me={extension:p.CacheParser,test:s=>Array.isArray(s)&&s.every(e=>e instanceof z),getCacheableAssets:(s,e)=>{const t={};return s.forEach(i=>{e.forEach((a,r)=>{t[i+(r===0?"":r+1)]=a})}),t}};async function N(s){if("Image"in globalThis)return new Promise(e=>{const t=new Image;t.onload=()=>{e(!0)},t.onerror=()=>{e(!1)},t.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(s)).blob();await createImageBitmap(e)}catch{return!1}return!0}return!1}const Ae={extension:{type:p.DetectionParser,priority:1},test:async()=>N("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(e=>e!=="avif")},V=["png","jpg","jpeg"],ge={extension:{type:p.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...V],remove:async s=>s.filter(e=>!V.includes(e))},ye="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function j(s){return ye?!1:document.createElement("video").canPlayType(s)!==""}const we={extension:{type:p.DetectionParser,priority:0},test:async()=>j("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(e=>e!=="mp4"&&e!=="m4v")},ve={extension:{type:p.DetectionParser,priority:0},test:async()=>j("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(e=>e!=="ogv")},_e={extension:{type:p.DetectionParser,priority:0},test:async()=>j("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(e=>e!=="webm")},be={extension:{type:p.DetectionParser,priority:0},test:async()=>N("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(e=>e!=="webp")};class xe{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{var n,c;let a=null,r=null;if(t.loadParser&&(r=this._parserHash[t.loadParser],r||m(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!r){for(let d=0;d<this.parsers.length;d++){const l=this.parsers[d];if(l.load&&((n=l.test)!=null&&n.call(l,e,t,this))){r=l;break}}if(!r)return m(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}a=await r.load(e,t,this),i.parser=r;for(let d=0;d<this.parsers.length;d++){const l=this.parsers[d];l.parse&&l.parse&&await((c=l.testParse)==null?void 0:c.call(l,a,t,this))&&(a=await l.parse(a,t,this)||a,i.parser=l)}return a})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const a={},r=X(e),n=k(e,l=>({alias:[l],src:l})),c=n.length,d=n.map(async l=>{const h=P.toAbsolute(l.src);if(!a[l.src])try{this.promiseCache[h]||(this.promiseCache[h]=this._getLoadPromiseAndParser(h,l)),a[l.src]=await this.promiseCache[h].promise,t&&t(++i/c)}catch(o){throw delete this.promiseCache[h],delete a[l.src],new Error(`[Loader.load] Failed to load ${h}.
${o}`)}});return await Promise.all(d),r?a[n[0].src]:a}async unload(e){const i=k(e,a=>({alias:[a],src:a})).map(async a=>{var c,d;const r=P.toAbsolute(a.src),n=this.promiseCache[r];if(n){const l=await n.promise;delete this.promiseCache[r],await((d=(c=n.parser)==null?void 0:c.unload)==null?void 0:d.call(c,l,a,this))}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(t.name?e[t.name]&&m(`[Assets] loadParser name conflict "${t.name}"`):m("[Assets] loadParser should have a name"),{...e,[t.name]:t}),{})}}function _(s,e){if(Array.isArray(e)){for(const t of e)if(s.startsWith(`data:${t}`))return!0;return!1}return s.startsWith(`data:${e}`)}function b(s,e){const t=s.split("?")[0],i=P.extname(t).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const Be=".json",ke="application/json",Le={extension:{type:p.LoadParser,priority:E.Low},name:"loadJson",test(s){return _(s,ke)||b(s,Be)},async load(s){return await(await A.get().fetch(s)).json()}},Pe=".txt",Ee="text/plain",Re={name:"loadTxt",extension:{type:p.LoadParser,priority:E.Low},test(s){return _(s,Ee)||b(s,Pe)},async load(s){return await(await A.get().fetch(s)).text()}},Ce=["normal","bold","100","200","300","400","500","600","700","800","900"],Ie=[".ttf",".otf",".woff",".woff2"],Te=["font/ttf","font/otf","font/woff","font/woff2"],Oe=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Ue(s){const e=P.extname(s),a=P.basename(s,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1));let r=a.length>0;for(const c of a)if(!c.match(Oe)){r=!1;break}let n=a.join(" ");return r||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}const We=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Me(s){return We.test(s)?s:encodeURI(s)}const je={extension:{type:p.LoadParser,priority:E.Low},name:"loadWebFont",test(s){return _(s,Te)||b(s,Ie)},async load(s,e){var i,a,r;const t=A.get().getFontFaceSet();if(t){const n=[],c=((i=e.data)==null?void 0:i.family)??Ue(s),d=((r=(a=e.data)==null?void 0:a.weights)==null?void 0:r.filter(h=>Ce.includes(h)))??["normal"],l=e.data??{};for(let h=0;h<d.length;h++){const o=d[h],u=new FontFace(c,`url(${Me(s)})`,{...l,weight:o});await u.load(),t.add(u),n.push(u)}return f.set(`${c}-and-url`,{url:s,fontFaces:n}),n.length===1?n[0]:n}return m("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(e=>{f.remove(e.family),A.get().getFontFaceSet().delete(e)})}};function F(s,e=1){var i;const t=(i=T.RETINA_PREFIX)==null?void 0:i.exec(s);return t?parseFloat(t[1]):e}function S(s,e,t){s.label=t,s._sourceOrigin=t;const i=new z({source:s,label:t}),a=()=>{delete e.promiseCache[t],f.has(t)&&f.remove(t)};return i.source.once("destroy",()=>{e.promiseCache[t]&&(m("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),a())}),i.once("destroy",()=>{s.destroyed||(m("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),a())}),i}const Fe=".svg",Se="image/svg+xml",Ve={extension:{type:p.LoadParser,priority:E.Low},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return _(s,Se)||b(s,Fe)},async load(s,e,t){return e.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?Ge(s):De(s,e,t,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function De(s,e,t,i){var R,C,I;const r=await(await A.get().fetch(s)).blob(),n=URL.createObjectURL(r),c=new Image;c.src=n,c.crossOrigin=i,await c.decode(),URL.revokeObjectURL(n);const d=document.createElement("canvas"),l=d.getContext("2d"),h=((R=e.data)==null?void 0:R.resolution)||F(s),o=((C=e.data)==null?void 0:C.width)??c.width,u=((I=e.data)==null?void 0:I.height)??c.height;d.width=o*h,d.height=u*h,l.drawImage(c,0,0,o*h,u*h);const{parseAsGraphicsContext:x,...O}=e.data,g=new H({resource:d,alphaMode:"premultiply-alpha-on-upload",resolution:h,...O});return S(g,t,s)}async function Ge(s){const t=await(await A.get().fetch(s)).text(),i=new K;return i.svg(t),i}const $e=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let w=null,M=class{constructor(){w||(w=URL.createObjectURL(new Blob([$e],{type:"application/javascript"}))),this.worker=new Worker(w)}};M.revokeObjectURL=function(){w&&(URL.revokeObjectURL(w),w=null)};const ze=`(function () {
    'use strict';

    async function loadImageBitmap(url) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      const imageBitmap = await createImageBitmap(imageBlob);
      return imageBitmap;
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let v=null;class Y{constructor(){v||(v=URL.createObjectURL(new Blob([ze],{type:"application/javascript"}))),this.worker=new Worker(v)}}Y.revokeObjectURL=function(){v&&(URL.revokeObjectURL(v),v=null)};let D=0,W;class Xe{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new M;t.addEventListener("message",i=>{t.terminate(),M.revokeObjectURL(),e(i.data)})}),this._isImageBitmapSupported)}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){W===void 0&&(W=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<W&&(this._createdWorkers++,e=new Y().worker,e.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){e.error!==void 0?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((a,r)=>{this._queue.push({id:e,arguments:t,resolve:a,reject:r})});return this._next(),i}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),i=t.id;this._resolveHash[D]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:D++,id:i})}}const G=new Xe,He=[".jpeg",".jpg",".png",".webp",".avif"],Ke=["image/jpeg","image/png","image/webp","image/avif"];async function Ne(s){const e=await A.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const t=await e.blob();return await createImageBitmap(t)}const Q={name:"loadTextures",extension:{type:p.LoadParser,priority:E.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return _(s,Ke)||b(s,He)},async load(s,e,t){var r;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await G.isImageBitmapSupported()?i=await G.loadImageBitmap(s):i=await Ne(s):i=await new Promise(n=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?n(i):i.onload=()=>{n(i)}});const a=new H({resource:i,alphaMode:"premultiply-alpha-on-upload",resolution:((r=e.data)==null?void 0:r.resolution)||F(s),...e.data});return S(a,t,s)},unload(s){s.destroy(!0)}},Z=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Ye=Z.map(s=>`video/${s.substring(1)}`);function Qe(s,e,t){t===void 0&&!e.startsWith("data:")?s.crossOrigin=Je(e):t!==!1&&(s.crossOrigin=typeof t=="string"?t:"anonymous")}function Ze(s){return new Promise((e,t)=>{s.addEventListener("canplaythrough",i),s.addEventListener("error",a),s.load();function i(){r(),e()}function a(n){r(),t(n)}function r(){s.removeEventListener("canplaythrough",i),s.removeEventListener("error",a)}})}function Je(s,e=globalThis.location){if(s.startsWith("data:"))return"";e=e||globalThis.location;const t=new URL(s,document.baseURI);return t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol?"anonymous":""}const qe={name:"loadVideo",extension:{type:p.LoadParser},config:null,test(s){const e=_(s,Ye),t=b(s,Z);return e||t},async load(s,e,t){var d,l;const i={...U.defaultOptions,resolution:((d=e.data)==null?void 0:d.resolution)||F(s),alphaMode:((l=e.data)==null?void 0:l.alphaMode)||await q(),...e.data},a=document.createElement("video"),r={preload:i.autoLoad!==!1?"auto":void 0,"webkit-playsinline":i.playsinline!==!1?"":void 0,playsinline:i.playsinline!==!1?"":void 0,muted:i.muted===!0?"":void 0,loop:i.loop===!0?"":void 0,autoplay:i.autoPlay!==!1?"":void 0};Object.keys(r).forEach(h=>{const o=r[h];o!==void 0&&a.setAttribute(h,o)}),i.muted===!0&&(a.muted=!0),Qe(a,s,i.crossorigin);const n=document.createElement("source");let c;if(s.startsWith("data:"))c=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const h=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();c=U.MIME_TYPES[h]||`video/${h}`}return n.src=s,c&&(n.type=c),new Promise(h=>{const o=async()=>{const u=new U({...i,resource:a});a.removeEventListener("canplay",o),e.data.preload&&await Ze(a),h(S(u,t,s))};a.addEventListener("canplay",o),a.appendChild(n)})},unload(s){s.destroy(!0)}},J={extension:p.ResolveParser,test:Q.test,parse:s=>{var e;return{resolution:parseFloat(((e=T.RETINA_PREFIX.exec(s))==null?void 0:e[1])??"1"),format:s.split(".").pop(),src:s}}},et={extension:p.ResolveParser,test:s=>T.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:J.parse};class tt{constructor(){this._detections=[],this._initialized=!1,this.resolver=new T,this.loader=new xe,this.cache=f,this._backgroundLoader=new fe(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){var r,n;if(this._initialized){m("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let c=e.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const t=((r=e.texturePreference)==null?void 0:r.resolution)??1,i=typeof t=="number"?[t]:t,a=await this._detectFormats({preferredFormats:(n=e.texturePreference)==null?void 0:n.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:a,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const i=X(e),a=k(e).map(c=>{if(typeof c!="string"){const d=this.resolver.getAlias(c);return d.some(l=>!this.resolver.hasKey(l))&&this.add(c),Array.isArray(d)?d[0]:d}return this.resolver.hasKey(c)||this.add({alias:c,src:c}),c}),r=this.resolver.resolve(a),n=await this._mapLoadToResolve(r,t);return i?n[a[0]]:n}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;typeof e=="string"&&(i=!0,e=[e]);const a=this.resolver.resolveBundle(e),r={},n=Object.keys(a);let c=0,d=0;const l=()=>{t==null||t(++c/d)},h=n.map(o=>{const u=a[o];return d+=Object.keys(u).length,this._mapLoadToResolve(u,l).then(x=>{r[o]=x})});return await Promise.all(h),i?r[e[0]]:r}async backgroundLoad(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),typeof e=="string"&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if(typeof e=="string")return f.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=f.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const a=await this.loader.load(i,t);this._backgroundLoader.active=!0;const r={};return i.forEach(n=>{const c=a[n.src],d=[n.src];n.alias&&d.push(...n.alias),d.forEach(l=>{r[l]=c}),f.set(d,c)}),r}async unload(e){this._initialized||await this.init();const t=k(e).map(a=>typeof a!="string"?a.src:a),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=k(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(a=>this._unloadFromResolved(t[a]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(i=>{f.remove(i.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((i,a)=>t.indexOf(i)===a),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(i=>i in e).forEach(i=>{t.config[i]=e[i]})})}}const B=new tt;L.handleByList(p.LoadParser,B.loader.parsers).handleByList(p.ResolveParser,B.resolver.parsers).handleByList(p.CacheParser,B.cache.parsers).handleByList(p.DetectionParser,B.detections);L.add(me,ge,Ae,be,we,ve,_e,Le,Re,je,Ve,Q,qe,J,et);const $={loader:p.LoadParser,resolver:p.ResolveParser,cache:p.CacheParser,detection:p.DetectionParser};L.handle(p.Asset,s=>{const e=s.ref;Object.entries($).filter(([t])=>!!e[t]).forEach(([t,i])=>L.add(Object.assign(e[t],{extension:e[t].extension??i})))},s=>{const e=s.ref;Object.keys($).filter(t=>!!e[t]).forEach(t=>L.remove(e[t]))});class st extends ee{constructor(e,t){const{text:i,resolution:a,style:r,anchor:n,width:c,height:d,roundPixels:l,...h}=e;super({...h}),this.batched=!0,this.resolution=null,this._didTextUpdate=!0,this._roundPixels=0,this._bounds=new te,this._boundsDirty=!0,this._styleClass=t,this.text=i??"",this.style=r,this.resolution=a??null,this.allowChildren=!1,this._anchor=new se({_onUpdate:()=>{this.onViewUpdate()}}),n&&(this.anchor=n),this.roundPixels=l??!1,c&&(this.width=c),d&&(this.height=d)}get anchor(){return this._anchor}set anchor(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}get style(){return this._style}set style(e){var t;e=e||{},(t=this._style)==null||t.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){let i,a;typeof e!="object"?(i=e,a=t??e):(i=e.width,a=e.height??e.width),i!==void 0&&this._setWidth(i,this.bounds.width),a!==void 0&&this._setHeight(a,this.bounds.height)}addBounds(e){const t=this.bounds;e.addFrame(t.minX,t.minY,t.maxX,t.maxY)}containsPoint(e){const t=this.bounds.maxX,i=this.bounds.maxY,a=-t*this.anchor.x;let r=0;return e.x>=a&&e.x<=a+t&&(r=-i*this.anchor.y,e.y>=r&&e.y<=r+i)}onViewUpdate(){this._didChangeId+=1<<12,this._boundsDirty=!0,!this.didViewUpdate&&(this.didViewUpdate=!0,this._didTextUpdate=!0,this.renderGroup&&this.renderGroup.onChildViewUpdate(this))}_getKey(){return`${this.text}:${this._style.styleKey}`}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,(typeof e=="boolean"?e:e!=null&&e.style)&&this._style.destroy(e),this._style=null,this._text=null}}function it(s,e){let t=s[0]??{};return(typeof t=="string"||s[1])&&(ie(ae,`use new ${e}({ text: "hi!", style }) instead`),t={text:t,style:s[1]}),t}class at extends st{constructor(...e){const t=it(e,"Text");super(t,ce),this.renderPipeId="text"}_updateBounds(){const e=this._bounds,t=this._style.padding,i=this._anchor,a=le.measureText(this._text,this._style),{width:r,height:n}=a;e.minX=-i._x*r-t,e.maxX=e.minX+r,e.minY=-i._y*n-t,e.maxY=e.minY+n}}const rt=""+new URL("gm-94e48fc6.jpg",import.meta.url).href,dt={__name:"DisplayObject",setup(s){const e=de(null),t=()=>{const o=new y;return o.circle(30,30,10),o.fill("green"),o},i=()=>{const o=new y;return o.ellipse(80,30,10,20),o.stroke({color:"red",width:3}),o},a=()=>{const o=new y;return o.moveTo(140,18),o.lineTo(200,18),o.stroke({color:"green",width:1}),o.moveTo(140,28),o.lineTo(200,28),o.stroke({color:"red",width:2}),o.moveTo(140,38),o.lineTo(200,38),o.stroke({color:"yellow",width:3}),o},r=()=>{const o=`
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
      <path id="lineAB" d="M 100 350 l 150 -300" stroke="red"
      stroke-width="3" fill="none" />
      <path id="lineBC" d="M 250 50 l 150 300" stroke="red"
      stroke-width="3" fill="none" />
      <path d="M 175 200 l 150 0" stroke="green" stroke-width="3"
      fill="none" />
      <path d="M 100 350 q 150 -300 300 0" stroke="blue"
      stroke-width="5" fill="none" />
      <!-- Mark relevant points -->
      <g stroke="black" stroke-width="3" fill="red">
        <circle id="pointA" cx="100" cy="350" r="3" />
        <circle id="pointB" cx="250" cy="50" r="3" />
        <circle id="pointC" cx="400" cy="350" r="3" />
      </g>
    </svg>
  `,u=new y;return u.svg(o),u.position.set(220,0),u.scale.set(.15),u},n=()=>{const o=new ne().rect(-50,-50,100,100).circle(80,80,50).circle(80,-80,50).circle(-80,80,50).circle(-80,-80,50),u=new y;return u.path(o),u.stroke({color:"green",width:3}),u.position.set(60,100),u.scale.set(.2),u},c=()=>{const o=new K;return o.rect(150,90,30,30),o.stroke("red"),new y(o)},d=async()=>{const o=await B.load(rt),u=new oe(o);return u.width=80,u.height=45,u.position.set(30,150),u},l=()=>{const o=new at({text:"Hello Pixi!",style:{fontFamily:"Arial",fontSize:24,fill:"green",align:"center"}});return o.position.set(140,150),o},h=async o=>{const{element:u,boundingRect:x}=o,O=window.devicePixelRatio,g=new re;await g.init({width:x.width,height:x.height,antialias:!0,resolution:O}),u.appendChild(g.canvas);const R=[t(),i(),a(),r(),n(),c(),l()],C=[d()];g.stage.addChild(...R),Promise.all(C).then(I=>{g.stage.addChild(...I)})};return he(()=>{const o=e.value,u=o.getBoundingClientRect();h({element:o,boundingRect:u})}),(o,u)=>(ue(),pe("div",{ref_key:"boxElementRef",ref:e,class:"box"},null,512))}};export{dt as default};
